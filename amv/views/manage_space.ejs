<title>Manage Space | AMV System</title>
<%- include('layouts/main_layout') %>
    <div id="app">
        <%- include('partials/sidebar') %>
        <div id="main">
          <%- include('partials/vertical_nav_bar.ejs') %>

            <script>
                const liElement = document.getElementById("sidenav-managespaces");
                liElement.classList.add('active');
            
            </script>
            
<div class="page-heading">
    <h3>Manage Space</h3>
</div>
<div class="page-content">
    <div class="col-12">
        <div class="card">
          <!-- <div class="card-header">
            <h5 class="card-title">Horizontal Navs</h5>
          </div> -->
          <div class="card-body">
            <ul class="nav nav-tabs" id="myTab" role="tablist">
              <li class="nav-item" role="presentation">
                <a class="nav-link" id="home-tab" data-bs-toggle="tab" href="#building" role="tab" aria-controls="home" aria-selected="false" tabindex="-1">Building</a>
              </li>
              <li class="nav-item" role="presentation">
                <a class="nav-link active" id="contact-tab" data-bs-toggle="tab" href="#room" role="tab" aria-controls="contact" aria-selected="true">Room</a>
              </li>
            </ul>

            <!-- BUILDING CONTENT -->

            <div class="tab-content" id="myTabContent">
              <div class="tab-pane fade" id="building" role="tabpanel" aria-labelledby="home-tab">
                <section>
                    <div class="row" id="table-hover-row">
                        <div class="col-12">
                            <div class="card-content">
                                <div class="card-body">
                                    <h4 class="card-title">Manage Buildings</h4>
                                    <div class="text-end">
                                        <a href="#" class="btn icon icon-left btn-success" data-bs-toggle="modal" data-bs-target="#modal-building-create">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-square" viewBox="0 0 16 16">
                                                <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                                                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                                        </svg> Add New Building</a>
                                    </div>

                                     <!--Extra Large Modal -->
                                  <div class="modal fade text-left w-100" id="modal-building-create" tabindex="-1" role="dialog"
                                  aria-labelledby="myModalLabel16" aria-hidden="true">
                                  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg"
                                      role="document">
                                      <div class="modal-content">
                                          <div class="modal-header">
                                              <h4 class="modal-title" id="myModalLabel16">Add New Building</h4>
                                              <button type="button" class="close" data-bs-dismiss="modal"
                                                  aria-label="Close">
                                                  <i data-feather="x"></i>
                                              </button>
                                          </div>
                                          <div class="modal-body">
                                          <div class="card-content">
                                          <div class="card-body">
                                          <form class="form form-horizontal" action="/manage-space/create-building" method="post">
                                              <div class="form-body">
                                                <div class="row">
                                                  <div class="col-md-4">
                                                    <label for="building-name-horizontal">Building Name</label>
                                                  </div>
                                                  <div class="col-md-8 form-group">
                                                    <input type="text" id="building-name-horizontal" class="form-control" name="building_name" value="" placeholder="Building Name">
                                                  </div>
                                                  <div class="col-md-4">
                                                    <label for="building-description-horizontal">Building Description</label>
                                                  </div>
                                                  <div class="col-md-8 form-group">
                                                    <textarea type="text" id="building-description-horizontal" class="form-control" name="building_desc" placeholder="Building Description"></textarea>
                                                  </div>
                                                  <div class="col-12 col-md-8 offset-md-4 form-group">
                                                    
                                                  </div>
                                                </div>
                                              </div>
                                          </div>
                                        </div>
                                        <div class="modal-footer">
                                            <div class="col-sm-12 d-flex justify-content-end">
                                                <button type="submit" class="btn btn-primary me-1 mb-1">
                                                  Add Building
                                                </button>
                                                <button type="reset" class="btn btn-light-secondary me-1 mb-1">
                                                  Reset
                                                </button>
                                            </div>
                                        </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--Modal full size -->
                                    
                        <br>
                              <br>
                            <div class="table-responsive">
                                <table class="table table-hover mb-0">
                                  <thead>
                                    <tr>
                                      <th>Building Name</th>
                                      <th>Number of Rooms</th>
                                      <th>Building Description</th>
                                      <th>ACTION</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                        <% buildings.forEach((building) => {  %>
                                              <tr>
                                                  <td class="text-bold-500"><%= building.building_name %></td>
                                                  <td>
                                                    <% let j = 0%>
                                                    <% for( let i = 0; i < rooms.length; i++ ) { %>
                                                        <% if (rooms[i].building_id == building.id) { %>
                                                            <% j += 1 %>
                                                        <% } %>
                                                    <% } %>
                                                    <%= j %>
                                                  </td>
                                                  <td><%= building.building_desc %></td>
                                                  <td>
                                                    <!-- <a href="#"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail badge-circle badge-circle-light-secondary font-medium-1"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a> -->
                                                    <a href="#" class="edit-button" data-bs-toggle="modal" data-bs-target="#modal-<%= building.id  %>"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                                                      <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                                                      <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
                                                    </svg></a>
                                                    <span> &nbsp &nbsp </span>
                                                    <a href="#" class="delete-button" data-bs-toggle="modal" data-bs-target="#delete-building-modal-<%= building.id  %>">
                                                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-trash3-fill" viewBox="0 0 16 16">
                                                        <path d="M11 1.5v1h3.5a.5.5 0 0 1 0 1h-.538l-.853 10.66A2 2 0 0 1 11.115 16h-6.23a2 2 0 0 1-1.994-1.84L2.038 3.5H1.5a.5.5 0 0 1 0-1H5v-1A1.5 1.5 0 0 1 6.5 0h3A1.5 1.5 0 0 1 11 1.5Zm-5 0v1h4v-1a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5ZM4.5 5.029l.5 8.5a.5.5 0 1 0 .998-.06l-.5-8.5a.5.5 0 1 0-.998.06Zm6.53-.528a.5.5 0 0 0-.528.47l-.5 8.5a.5.5 0 0 0 .998.058l.5-8.5a.5.5 0 0 0-.47-.528ZM8 4.5a.5.5 0 0 0-.5.5v8.5a.5.5 0 0 0 1 0V5a.5.5 0 0 0-.5-.5Z"/>
                                                      </svg>
                                                    </a>
                                                  </td>
                                                </tr>

                                                <!--DELETE MODAL -->
                                <div class="modal fade text-left" id="delete-building-modal-<%= building.id  %>" role="dialog"
                                aria-labelledby="myModalLabel33" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable"
                                    role="document">
                                    <div class="modal-content">
                                        <div class="modal-header bg-danger">
                                            <h4 class="modal-title white" id="myModalLabel33">Delete Building</h4>
                                            <button type="button" class="close" data-bs-dismiss="modal"
                                                aria-label="Close">
                                                <i data-feather="x"></i>
                                            </button>
                                        </div>
                                        <form action="/manage-space/delete-building" method="post">
                                            <div class="modal-body">
                                                <p>Are you sure you want to delete <%= building.building_name %>?</p>
                                                <label hidden>ID: </label>
                                                <div class="form-group" hidden>
                                                    <input type="text" name="id" value="<%= building.id %>"
                                                        class="form-control">
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-light-secondary"
                                                    data-bs-dismiss="modal">
                                                    <i class="bx bx-x d-block d-sm-none"></i>
                                                    <span class="d-none d-sm-block">Close</span>
                                                </button>
                                                <button type="submit" class="btn btn-danger ml-1"
                                                    data-bs-dismiss="modal">
                                                    <i class="bx bx-check d-block d-sm-none"></i>
                                                    <span class="d-none d-sm-block">Delete</span>
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                                </div>
  
                                                 <!--EDIT and UPDATE MODAL -->
                                  <div class="modal fade text-left w-100" id="modal-<%= building.id  %>" tabindex="-1" role="dialog"
                                      aria-labelledby="myModalLabel16" aria-hidden="true">
                                      <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg"
                                          role="document">
                                          <div class="modal-content">
                                              <div class="modal-header">
                                                  <h4 class="modal-title" id="myModalLabel16">Edit Building Information</h4>
                                                  <button type="button" class="close" data-bs-dismiss="modal"
                                                      aria-label="Close">
                                                      <i data-feather="x"></i>
                                                  </button>
                                              </div>
                                              <div class="modal-body">
                                              <div class="card-content">
                                              <div class="card-body">
                                              <form class="form form-horizontal" action="/manage-space/update-building" method="post">
                                                  <div class="form-body">
                                                    <div class="row">
                                                          <div class="col-md-4" hidden>
                                                            <label for="building-name-horizontal">Building ID</label>
                                                          </div>
                                                          <div class="col-md-8 form-group" hidden>
                                                            <input type="text" id="building-name-horizontal" class="form-control" name="id" value="<%= building.id %>" placeholder="Building Name">
                                                          </div>
                                                          <div class="col-md-4">
                                                            <label for="building-name-horizontal">Building Name</label>
                                                          </div>
                                                          <div class="col-md-8 form-group">
                                                            <input type="text" id="building-name-horizontal" class="form-control" name="building_name" value="<%= building.building_name %>" placeholder="Building Name">
                                                          </div>
                                                          <div class="col-md-4">
                                                            <label for="building-description-horizontal">Building Description</label>
                                                          </div>
                                                          <div class="col-md-8 form-group">
                                                            <textarea type="text" id="building-description-horizontal" class="form-control" name="building_desc" placeholder="Building Description"><%= building.building_desc %></textarea>
                                                          </div>
                                                          <div class="col-12 col-md-8 offset-md-4 form-group">
                                                            
                                                          </div>
                                                    </div>
                                                  </div>
                                              </div>
                                              </div>
  
                                              <div class="modal-footer">
                                                  <div class="col-sm-12 d-flex justify-content-end">
                                                      <button type="submit" class="btn btn-primary me-1 mb-1">
                                                        Update Building Info
                                                      </button>
                                                      <button type="reset" class="btn btn-light-secondary me-1 mb-1">
                                                        Reset
                                                      </button>
                                              </div>
                                              </form>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                              <!--Modal full size -->
  
                                          
                                      <% }) %>
                                  </tbody>
                                </table>
                              </div>
                            </div>

                            </div>
                        </div>
                    </div>
                </section>
              </div>

              <!-- ROOM CONTENT -->

              <div class="tab-pane fade active show" id="room" role="tabpanel" aria-labelledby="contact-tab">
                <!-- <p class="mt-2">
                  Duis ultrices purus non eros fermentum hendrerit.
                  Aenean ornare interdum viverra. Sed ut odio velit.
                  Aenean eu diam dictum nibh rhoncus mattis quis ac
                  risus. Vivamus eu congue ipsum. Maecenas id
                  sollicitudin ex. Cras in ex vestibulum, posuere orci
                  at, sollicitudin purus. Morbi mollis elementum enim,
                  in cursus sem placerat ut.
                </p> -->
                <section class="section">
                    <div class="row" id="table-hover-row">
                      <div class="col-12">
                        <!-- <div class="card">
                          <div class="card-header">
                            <h4 class="card-title">Manage Rooms</h4>
                          </div> -->
                          <div class="card-content">
                            <div class="card-body">
                                <h4 class="card-title">Manage Rooms</h4>
                                <div class="text-end">
                                    <a href="#" class="btn icon icon-left btn-success" data-bs-toggle="modal" data-bs-target="#modal-room-create">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-square" viewBox="0 0 16 16">
                                            <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                                            <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                                    </svg> Add New Room</a>
                                </div>
                                     <!--Extra Large Modal -->
                                  <div class="modal fade text-left w-100" id="modal-room-create" tabindex="-1" role="dialog"
                                    aria-labelledby="myModalLabel16" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg"
                                        role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h4 class="modal-title" id="myModalLabel16">Add New Room</h4>
                                                <button type="button" class="close" data-bs-dismiss="modal"
                                                    aria-label="Close">
                                                    <i data-feather="x"></i>
                                                </button>
                                            </div>
                                            <div class="modal-body">
                                            <div class="card-content">
                                            <div class="card-body">
                                            <form class="form form-horizontal" action="/manage-space/create-room" method="post">
                                                <div class="form-body">
                                                  <div class="row">
                                                    <div class="col-md-4">
                                                      <label for="room-name-horizontal">Room Name</label>
                                                    </div>
                                                    <div class="col-md-8 form-group">
                                                      <input type="text" id="room-name-horizontal" class="form-control" name="room_name" value="" placeholder="Room Name">
                                                    </div>
                                                    <div class="col-md-4">
                                                      <label for="building-id-horizontal">Building</label>
                                                    </div>
                                                    <div class="col-md-8 form-group">
                                                        <select class="form-select" id="inputGroupSelect01" name="building_id">
                                                            <option selected disabled>Select Building...</option>
                                                            <% buildings.forEach(building => { %>
                                                                <option value="<%= building.id %>"><%= building.building_name %></option>
                                                            <% }) %>
                                                        </select>
                                                    </div>
                                                    <div class="col-md-4">
                                                      <label for="sensor-id-horizontal-">Sensor ID</label>
                                                    </div>
                                                    <div class="col-md-8 form-group">
                                                      <input type="text" id="sensor-id-horizontal-" class="form-control" name="device_id" value="" placeholder="Sensor ID">
                                                      <!-- <p class="text-subtitle text-muted" id="input-active-indicator-"></p> -->
                                                    </div>
                                                    <div class="col-md-4">
                                                      <label for="room-description-horizontal">Room Description</label>
                                                    </div>
                                                    <div class="col-md-8 form-group">
                                                      <textarea type="text" id="room-description-horizontal" class="form-control" name="room_desc" placeholder="Room Description"></textarea>
                                                    </div>
                                                    
                                                    <div class="col-12 col-md-8 offset-md-4 form-group">
                                                      
                                                    </div>
                                                  </div>
                                                </div>
                                            </div>
                                            </div>

                                            <div class="modal-footer">
                                                <div class="col-sm-12 d-flex justify-content-end">
                                                    <button type="submit" class="btn btn-primary me-1 mb-1">
                                                      Add Room
                                                    </button>
                                                    <button type="reset" class="btn btn-light-secondary me-1 mb-1">
                                                      Reset
                                                    </button>
                                            </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </div>
                            <!--Modal full size -->
                                
                              <!-- <p>
                                Add
                                <code class="highlighter-rouge">.table-hover</code> to
                                enable a hover state on table rows within a
                                <code class="highlighter-rouge">&lt;tbody&gt;</code>.
                              </p> -->
                              <!-- table hover -->
                              <br>
                              <br>
                            <div class="table-responsive">
                                <table class="table table-hover mb-0">
                                  <thead>
                                    <tr>
                                      <th>Room Name</th>
                                      <th>Sensor ID</th>
                                      <th>Building</th>
                                      <th>Room Description</th>
                                      <th>Status</th>
                                      <th>ACTION</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                      <% rooms.forEach((room) => { %>
                                          <% buildings.forEach((building) => {  if(building.id == room.building_id) { %>
                                              <tr>
                                                  <td class="text-bold-500"><%= room.room_name %></td>
                                                  <td><%= room.device_id %></td>
                                                  <td class="text-bold-500"><%= building.building_name %></td>
                                                  <td><%= room.room_desc %></td>
                                                  <td id="status-<%= room.device_id %>">Offline or No Sensor ID Match</td>
                                                  <td>
                                                    <!-- <a href="#"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail badge-circle badge-circle-light-secondary font-medium-1"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a> -->
                                                    <a href="#" class="edit-button" data-bs-toggle="modal" data-bs-target="#room-modal-<%= room.id  %>"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                                                      <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                                                      <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
                                                    </svg></a>
                                                    <span> &nbsp &nbsp </span>
                                                    <a href="#" class="delete-button" data-bs-toggle="modal" data-bs-target="#delete-room-modal-<%= room.id  %>">
                                                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-trash3-fill" viewBox="0 0 16 16">
                                                        <path d="M11 1.5v1h3.5a.5.5 0 0 1 0 1h-.538l-.853 10.66A2 2 0 0 1 11.115 16h-6.23a2 2 0 0 1-1.994-1.84L2.038 3.5H1.5a.5.5 0 0 1 0-1H5v-1A1.5 1.5 0 0 1 6.5 0h3A1.5 1.5 0 0 1 11 1.5Zm-5 0v1h4v-1a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5ZM4.5 5.029l.5 8.5a.5.5 0 1 0 .998-.06l-.5-8.5a.5.5 0 1 0-.998.06Zm6.53-.528a.5.5 0 0 0-.528.47l-.5 8.5a.5.5 0 0 0 .998.058l.5-8.5a.5.5 0 0 0-.47-.528ZM8 4.5a.5.5 0 0 0-.5.5v8.5a.5.5 0 0 0 1 0V5a.5.5 0 0 0-.5-.5Z"/>
                                                      </svg>
                                                    </a>
                                                  </td>
                                                </tr>

                                    <!--DELETE ROOM MODAL -->
                                <div class="modal fade text-left" id="delete-room-modal-<%= room.id  %>" role="dialog"
                                    aria-labelledby="myModalLabel33" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable"
                                        role="document">
                                        <div class="modal-content">
                                            <div class="modal-header bg-danger">
                                                <h4 class="modal-title white" id="myModalLabel33">Delete Room</h4>
                                                <button type="button" class="close" data-bs-dismiss="modal"
                                                    aria-label="Close">
                                                    <i data-feather="x"></i>
                                                </button>
                                            </div>
                                            <form action="/manage-space/delete-room" method="post">
                                                <div class="modal-body">
                                                    <p>Are you sure you want to delete <%= room.room_name %>?</p>
                                                    <label hidden>ID: </label>
                                                    <div class="form-group" hidden>
                                                        <input type="text" name="id" value="<%= room.id %>"
                                                            class="form-control">
                                                    </div>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-light-secondary"
                                                        data-bs-dismiss="modal">
                                                        <i class="bx bx-x d-block d-sm-none"></i>
                                                        <span class="d-none d-sm-block">Close</span>
                                                    </button>
                                                    <button type="submit" class="btn btn-danger ml-1"
                                                        data-bs-dismiss="modal">
                                                        <i class="bx bx-check d-block d-sm-none"></i>
                                                        <span class="d-none d-sm-block">Delete</span>
                                                    </button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                    </div>
  
                                                 <!--Extra Large Modal -->
                                  <div class="modal fade text-left w-100" id="room-modal-<%= room.id  %>" tabindex="-1" role="dialog"
                                      aria-labelledby="myModalLabel16" aria-hidden="true">
                                      <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg"
                                          role="document">
                                          <div class="modal-content">
                                              <div class="modal-header">
                                                  <h4 class="modal-title" id="myModalLabel16">Edit Room Information</h4>
                                                  <button type="button" class="close" data-bs-dismiss="modal"
                                                      aria-label="Close">
                                                      <i data-feather="x"></i>
                                                  </button>
                                              </div>
                                              <div class="modal-body">
                                                  <!-- <h4 class="card-title"> Room Name: <%= room.room_name %></h4>
                                                  <h6 class="card-subtitle">Building:  <%= building.building_name %> </h6>
                                                  <h6 class="card-subtitle">Sensor ID: <%= room.device_id %></h6>
                                                  <h6 class="card-subtitle">Room Description: <%= room.room_desc %></h6>
                                                  <h6 class="card-subtitle">Building Description: <%= building.building_desc %></h6>
                                                  <div id="modal-device-<%= room.device_id %>">
                                                      <p>Offline or No Sensor ID Match</p>
                                                  </div>
                                                  <div id="device-<%= room.device_id %>">
                                                      <canvas id="myChart-<%= room.device_id %>"></canvas> 
                                                  </div> -->
                                                  <h6 class="card-subtitle">Status:  <span id="modal-status-<%= room.device_id %>">Offline - No Sensor ID Match</span> </h6>
                                              <div class="card-content">
                                              <div class="card-body">
                                              <form class="form form-horizontal" action="/manage-space/update-room" method="post">
                                                  <div class="form-body">
                                                    <div class="row">
                                                      <div class="col-md-4" hidden>
                                                          <label for="id-horizontal">ID</label>
                                                        </div>
                                                        <div class="col-md-8 form-group" hidden>
                                                          <input type="text" id="id-horizontal" class="form-control" name="id" value="<%= room.id %>" placeholder="First Name">
                                                        </div>
                                                      <div class="col-md-4">
                                                        <label for="room-name-horizontal">Room Name</label>
                                                      </div>
                                                      <div class="col-md-8 form-group">
                                                        <input type="text" id="room-name-horizontal" class="form-control" name="room_name" value="<%= room.room_name %>" placeholder="Room Name">
                                                      </div>
                                                      <div class="col-md-4">
                                                        <label for="building-id-horizontal">Building</label>
                                                      </div>
                                                      <div class="col-md-8 form-group">
                                                          <select class="form-select" id="inputGroupSelect01" name="building_id">
                                                              <option selected value="<%= room.building_id %>" disabled>
                                                                <% buildings.forEach(building => { %>
                                                                    <% if (building.id == room.building_id) { %>
                                                                        <%= building.building_name %>
                                                                    <% } %>
                                                                <% }) %>
                                                              </option>
                                                              <% buildings.forEach(building => { %>
                                                                  <option value="<%= building.id %>"><%= building.building_name %></option>
                                                              <% }) %>
                                                          </select>
                                                      </div>
                                                      <div class="col-md-4">
                                                        <label for="sensor-id-horizontal-<%= room.device_id %>">Sensor ID</label>
                                                      </div>
                                                      <div class="col-md-8 form-group">
                                                        <input type="text" id="sensor-id-horizontal-<%= room.device_id %>" class="form-control" name="device_id" value="<%= room.device_id %>" placeholder="Sensor ID">
                                                        <!-- <p class="text-subtitle text-muted" id="input-active-indicator-<%= room.device_id %>"></p> -->
                                                      </div>
                                                      <div class="col-md-4">
                                                        <label for="room-description-horizontal">Room Description</label>
                                                      </div>
                                                      <div class="col-md-8 form-group">
                                                        <textarea type="text" id="room-description-horizontal" class="form-control" name="room_desc" placeholder="Room Description"><%= room.room_desc %></textarea>
                                                      </div>
                                                      
                                                      <div class="col-12 col-md-8 offset-md-4 form-group">
                                                        
                                                      </div>
                                                    </div>
                                                  </div>
                                              </div>
                                              </div>
  
                                              <div class="modal-footer">
                                                  <div class="col-sm-12 d-flex justify-content-end">
                                                      <button type="submit" class="btn btn-primary me-1 mb-1">
                                                        Update Room Info
                                                      </button>
                                                      <button type="reset" class="btn btn-light-secondary me-1 mb-1">
                                                        Reset
                                                      </button>
                                              </div>
                                              </form>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                              <!--Modal full size -->
  
                                          <% }}) %>
                                      <% }) %>
                                  </tbody>
                                </table>
                              </div>
                            </div>
                            
                          </div>
                        </div>
                      </div>
                    </div>
                </section>
              </div>
            </div>
          </div>
        </div>
      </div>
      <%- include('layouts/footer_layout') %>
</div>

    
    <script src="/socket.io/socket.io.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script>
        socket.on('data', (data) => {
            const statusId = 'status-' + data.device_id;
            
            let statusIndicatior = document.getElementById(statusId);
            if(statusIndicatior){
                statusIndicatior.innerText=`Active`
            }

            const modalStatusId = 'modal-status-' + data.device_id;
            let modalstatusIndicatior = document.getElementById(modalStatusId);
            if(modalstatusIndicatior){
                modalstatusIndicatior.innerText=`Active - Sensor Detected`
            }

            // const inputStatusId = 'input-active-indicator-' + data.device_id;
            // const inputStatusIndicatior = document.getElementById(inputStatusId);
            // if (inputStatusIndicatior){
            //     inputStatusIndicatior.innerText=`Sensor Detected`;
                
            // }
        });
    </script>
    <style>
        .delete-button svg {
          fill: rgb(253, 68, 68);
        }
        .edit-button svg {
          fill: rgb(149, 163, 26);
        }
      </style>

            
        </div>
    </div>
    <%- include('layouts/buttom_layout') %>
